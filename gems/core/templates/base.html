<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>GEM Survey</title>
		<meta name="generator" content="Bootply" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link href="{{ STATIC_URL }}css/bootstrap.min.css" rel="stylesheet">
        <link href="{{ STATIC_URL }}css/bootstrap-toggle.min.css" rel="stylesheet">
		<!--[if lt IE 9]>
			<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<link href="{{ STATIC_URL }}css/styles.css" rel="stylesheet">
        <script src="{{ STATIC_URL }}js/jquery-1.11.2.min.js"></script>
        <script src="{{ STATIC_URL }}js/angular.js"></script>
        <script src="{{ STATIC_URL }}js/bootstrap-toggle.min.js"></script>
        <script src="{{ STATIC_URL }}js/script.js"></script>
        <script src="{{ STATIC_URL }}js/toggleCheckbox.js"></script>
        <script src="{{ STATIC_URL }}js/QueryController.js"></script>
	</head>

<body ng-app="gems">
    <div class="container">

        <!-- upper section -->
        <div class="row">
            <!--{% include 'menu.html' %}-->


            <div ng-controller="queryController">
                <form ng-submit="">
                    <div class="row">
                        <h1>Create Group</h1>
                    </div>
                    <div class="row">
                        <h5>Define the rules of your contact group:</h5>
                    </div>
                    <div class="row" ng-repeat="filter in filters">
                        <div class="row" ng-if="$index != 0">
                            <div class="col-md-3">
                                <input toggle-checkbox class="form-control" data-on="and" data-off="or" ng-true-value="'and'" ng-false-value="'or'" ng-model="filter.loperator" type="checkbox">
                            </div>
                        </div>
                        <div class="row" ng-repeat="fieldFilter in filter.filters">
                            <div class="col-md-3" ng-if="$index == 0">
                                <select class="form-control" ng-model="filter.field" ng-options="field.name for field in fields"></select>
                            </div>
                            <div class="row" ng-if="$index != 0">
                                <div class="col-md-3 col-md-offset-5">
                                    <input toggle-checkbox class="form-control" data-on="and" data-off="or" ng-true-value="'and'" ng-false-value="'or'" ng-model="fieldFilter.loperator" type="checkbox">
                                </div>
                            </div>
                            <div class="col-md-3" ng-if="$index != 0">
                            </div>
                            <div class="col-md-3">
                                <select class="form-control" ng-model="fieldFilter.operator" ng-options="op.operator as op.name for op in operators"></select>
                            </div>
                            <div class="col-md-3" ng-model="filter.value">
                                <input class="form-control" placeholder="Value" ng-model="fieldFilter.value">
                            </div>
                            <div class="col-md-3" ng-if="$index != 0">
                                <div class="row">
                                    <div class="col-md-2">
                                        <a ng-click="removeFieldFilter($parent.$parent.$index, $index)"><img width="16" height="16" src="{{ STATIC_URL }}img/red_cross.png"></a>
                                    </div>
                                    <div class="col-md-10">
                                        <a ng-click="addFieldFilter($parent.$parent.$index)" href="">Add new condition+ #TODO STYLING</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3" ng-if="filter.filters.length == 1">
                                <div class="row">
                                    <div class="col-md-2" ng-if="$parent.$parent.$index != 0">
                                        <a ng-click="removeFilter($parent.$parent.$parent.$index)"><img width="16" height="16" src="{{ STATIC_URL }}img/red_cross.png"></a>
                                    </div>
                                    <div class="col-md-10">
                                        <a ng-click="addFieldFilter($parent.$parent.$index)" href="">Add new condition+ #TODO STYLING</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <a ng-click="addFilter()" href="">Add new data field #TODO STYLING</a>
                    </div>
                    <div class="row">
                        <h3 class="blue-front">{$queryWords$}</h3>
                    </div>
                    <div class="row">
                        <button class="btn btn-default green white-front" ng-click="fetchResults()">Display Results</button>
                    </div>
                    <div class="row">
                        &nbsp;
                    </div>
                    <div class="row" ng-if="queryStarted && results.length == 0">
                        <h4 class="grey-front">Sorry. There are no results that match your query. Please adjust your Rules.</h4>
                    </div>
                    <div class="row" ng-if="queryStarted && results.length > 0">

                    </div>
                </form>
            </div>

            {% block content %}
            {% endblock %}
        </div>
    </div>
</body>
